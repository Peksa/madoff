*{ Just a simple tag for Payments/show to avoid duplication, tag usage is bloated and ugly imo :( }*
*{ Takes payments, action:'pay'/'accept'/'none', outgoing:true/false}*

<ul>
#{if !_payments}
&{'views.tags.displayPayment.empty'}
#{/if}
#{list items:_payments, as:'payment'}
    <li>
    #{if payment.paid && _showDate}
    	${payment.paid.format('yyyy-MM-dd')}<br>
    #{/if}
    %{
    	if(_outgoing) user = payment.receiver
    	else user = payment.payer
    }%
	<a href="@{Users.show(user.username)}">${user.fullname} (${user.username})</a> : ${payment.amount.format('0.00')} SEK 
	#{if payment.identifier}
		- <strong>${payment.identifier}</strong>
	#{/if}
	#{if payment.receipts}
		<ul>
		#{list items:payment.receipts, as:'receipt'}
			<li>
			<a href="@{Receipts.show(receipt.id)}">${receipt.title}</a>
				&#40;${receipt.shouldPay(payment.payer,payment.receiver).format('0.00')}&#41;
			</li>
		#{/list}
		</ul>
		#{if _action == 'pay'}
			#{form @Payments.pay(payment.id)}
				<input type="submit" class="btn success small" value="&{'Paid'}"/>
			#{/form}
			#{form @Payments.reject(payment.id)}
				<input type="submit" class="btn error small" value="&{'Reject'}"/>
			#{/form}
		#{/if}
		#{if _action == 'accept'}
			#{form @Payments.accept(payment.id)}
				<input type="submit" class="btn success small" value="&{'views.tags.displayPayment.accept'}"/>
			#{/form}
			#{form @Payments.reject(payment.id)}
				<input type="submit" class="btn error small" value="&{'Reject'}"/>
			#{/form}
		#{/if}
		#{if _action == 'release'}
			#{form @Payments.release(payment.id)}
				<input type="submit" class="btn error small" value="&{'Release'}"/>
			#{/form}
		#{/if}
	#{/if}
	</li>
#{/list}
</ul>