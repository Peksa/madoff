*{ Just a simple tag for Payments/show to avoid duplication, tag usage is bloated and ugly imo :( }*

<ul>
#{list items:_debt.keySet(), as:'user'}
	%{
		owes = _debt.get(user);
		fresh = _freshDebt.get(user);
		receipts = _freshReceipts.get(user);
		
		if(!_positive) {
			owes = -owes
			fresh = fresh == null ? owes : -fresh
		}
	}%
	#{if owes > 0}
	    <li>
		${user.fullname} (${user.username}): ${owes} SEK *{Gunde12345 <button class="btn primary small">Pay</button>}*
		#{if receipts != null}
			#{if fresh != null && owes != fresh}
				${fresh} from:
			#{/if}
			<ul>
			#{list items:receipts, as:'receipt'}
				%{
					if(receipt.owner.equals(_activeUser)) {
						receiptDebt = receipt.getTotal(user)
						if(_positive) receiptDebt *= -1
					} else {
						receiptDebt = receipt.getTotal(_activeUser)
						if(!_positive) receiptDebt *= -1
					}
				}%
				<li>
				<a href="@{Receipts.show(receipt.id)}">${receipt.title}</a> (${receiptDebt})
				
				</li>
			#{/list}
			</ul>
		#{/if}
		</li>
	#{/if}
#{/list}
</ul>