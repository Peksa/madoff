#{extends 'main.html' /}
#{set 'title'}
	&{'views.Receipts.register.Title'}
#{/set}
#{set 'moreScripts'} #{script 'chosen.jquery.min.js' /} #{/set}
#{set 'moreStyles'} #{stylesheet 'chosen.css' /} #{/set}

<div id="register">


	#{if flash.error}
	<div class="alert-message error">
		<a class="close" href="#">&times;</a> 
		<p>
			<strong>&{'error'}</strong> &{flash.error}
		</p>
	</div>
	#{/if}
	#{form @add()}
	<fieldset>
		<legend>&{'views.Receipts.register.addNew'}</legend>
		<div class="page-header">
    		<h1><small>&{'Required'}</small></h1>
  		</div>
		<div class="clearfix">
			<label for="members">&{'Members'}:</label>
			<div class="input">
				<select data-placeholder="&{'views.Receipts.register.membersPlaceholder'}" class="chzn-select"
					style="width: 350px;" id="members" name="members" multiple="yes">
					<option value=""></option> 
					#{list items:members, as:'user'}
						<!-- Dividing line below into multiple lines breaks chosen autocomplete -->
						<option value="${user.id}" #{if currentUser.username == user.username}  selected="selected" #{/if}> ${user.fullname} (${user.username})</option> 
					#{/list}
				</select>
			</div>
		</div>	
		<div class="clearfix">
			<label for="title">&{'Title'}:</label>
			<div class="input">
				<input type="text" name="title" id="title" value="${flash.title}" />
			</div>
		</div>
		<div class="clearfix">
			<label for="description">&{'Description'}:</label>
			<div class="input">
				<textarea name="description" id="description" rows="4">${flash.description}</textarea>
			</div>
		</div>
		<div class="clearfix">
			<label for="date">&{'Date'}:</label>
			<div class="input">
				<input type="text" id="datepicker" />
			</div>
		</div>
		<div class="clearfix">
			<label for="total">&{'Total'}:</label>
			<div class="input">
				<input type="text" name="total" id="total" value="${flash.total}" />
			</div>
		</div>
		
		<div class="page-header">
    		<h1><small>&{'Optional'}</small></h1>
  		</div>
		<div class="clearfix">
			<label for="username">&{'Tip'}:</label>
			<div class="input">
				<input type="text" name="tip" id="tip" value="${flash.tip}" />
			</div>
		</div>
		
		<!-- TODO this should be added dynamicly with javascript ofc -->
		#{list items:0..5, as:'i'}
		<div class="clearfix">
			<label for="username">&{'Subround:'}:</label>
			<div class="input">
				<select data-placeholder="&{'views.Receipts.register.membersPlaceholder'}" class="chzn-select"
					style="width: 350px;" name="subrounds[${i}].members" multiple="yes">
					<option value=""></option>
					#{list items:members, as:'user'}
						<!-- Dividing line below into multiple lines breaks chosen autocomplete -->
						<option value="${user.id}"> ${user.fullname} (${user.username})</option> 
					#{/list}
				</select>
			</div>
		</div>
		<div class="clearfix">
			<div class="input">
				&{'bought'}
				<input placeholder="item" class="span2" type="text" name="subrounds[${i}].description" id="herp" value="${flash.tip}" />
				&{'for'}
				<input placeholder="money amount" class="span2" type="text" name="subrounds[${i}].amount" id="derp" value="${flash.tip}" />
			</div>
			
			<div class="input">
				
			</div>
			
			<div class="input">
				
			</div>
		</div>
		#{/list}
		
		<div class="actions">
			<input class="btn primary" type="submit" id="register" value="&{'Add'}" />
			<a href="@{Application.index()}" class="btn">&{'Cancel'}</a>
		</div>
	</fieldset>

	#{/form}

	<script type="text/javascript">
		$(function() {
			$("#datepicker").datepicker({dateFormat: 'yy-mm-dd'});
		});

	</script>
	<script type="text/javascript">$(".chzn-select").chosen(); </script>
</div>